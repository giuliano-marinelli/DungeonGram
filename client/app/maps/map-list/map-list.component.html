<div class="card map-container own" *ngIf="auth.loggedIn">
  <h4 class="card-header">My Maps</h4>
  <div class="card-body" *ngIf="isLoadingOwn">
    <app-loading [condition]="isLoadingOwn"></app-loading>
  </div>
  <div class="card-body" *ngIf="!isLoadingOwn">
    <!-- <p class="card-text">
      <span class="d-inline-block" tippy="You must be logged in to create maps" placement="right"
        [isEnabled]="!auth.loggedIn">
        <button type="button" class="btn btn-dark map-btn" (click)="openMap()" [disabled]="!auth.loggedIn"
          attr.style="{{!auth.loggedIn ? 'pointer-events: none;' : ''}}">
          <i class="fa fa-plus"></i> New Map
        </button>
      </span>
    </p> -->
    <p *ngIf="ownMaps.length <= 0" class="card-text">
      You have not created maps yet
    </p>
    <div *ngIf="ownMaps.length > 0"
      class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 row-cols-xl-5">
      <div *ngFor="let map of ownMaps" class="col mb-4">
        <ng-container [ngTemplateOutlet]="mapCard" [ngTemplateOutletContext]="{map: map}">
        </ng-container>
      </div>
    </div>
    <ngb-pagination *ngIf="countOwnMaps > 0" class="d-flex justify-content-end" [(page)]="pageOwnMaps"
      [pageSize]="pageSizeOwnMaps" [collectionSize]="countOwnMaps" (pageChange)="getMaps(true)">
    </ngb-pagination>
  </div>
</div>

<div class="card map-container">
  <h4 class="card-header">Public Maps</h4>
  <div class="card-body" *ngIf="isLoadingPublic">
    <app-loading [condition]="isLoadingPublic"></app-loading>
  </div>
  <div class="card-body" *ngIf="!isLoadingPublic">
    <p *ngIf="publicMaps.length <= 0" class="card-text">
      There are no public maps created yet
    </p>
    <div *ngIf="publicMaps.length > 0"
      class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 row-cols-xl-5">
      <div *ngFor="let map of publicMaps" class="col mb-4">
        <ng-container [ngTemplateOutlet]="mapCard" [ngTemplateOutletContext]="{map: map}">
        </ng-container>
      </div>
    </div>
    <ngb-pagination *ngIf="countPublicMaps > 0" class="d-flex justify-content-end" [(page)]="pagePublicMaps"
      [pageSize]="pageSizePublicMaps" [collectionSize]="countPublicMaps"
      (pageChange)="getMaps(false)"></ngb-pagination>
  </div>
</div>

<ng-template #mapCard let-map='map'>
  <div class="card h-100">
    <img src="{{map.terrain}}" onerror="this.src='assets/images/game/default_terrain.png'"
      class="card-img-top map-img" alt="{{map.title}}">
    <div class="card-body map-card-body">
      <h5 class="card-title"><i *ngIf="map.private" tippy="This map is private"
          class="fa fa-user-secret">&nbsp;</i>{{map.name}}<br />
        <small class="text-muted">created by {{map.owner_info.username}}</small>
      </h5>
      <p class="card-text map-description mb-4" tippy="{{map.description}}" placement="right">
        {{map.description}}
      </p>
      <p class="card-text text-right position-absolute" style="bottom: 0.5rem; right: 0.5rem;">
        <!-- <button class="btn btn-sm btn-dark map-btn-alt ml-2" (click)="openMap(map)"
          [hidden]="auth.currentUser._id != map.owner" tippy="Edit">
          <i class="fa fa-pencil"></i>
        </button>
        <button class="btn btn-sm btn-danger ml-2" (confirm)="deleteMap(map)" confirmDoubleCheck="true"
          [hidden]="auth.currentUser._id != map.owner" tippy="Delete">
          <i class="fa fa-trash"></i>
        </button> -->
      </p>
    </div>
  </div>
</ng-template>
